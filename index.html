<!DOCTYPE html>
<html>
<head>
  <title>Add Heading and Paragraphs</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <style>
    #output {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Add Heading and Paragraphs</h1>

  <form id="myForm">
    <label for="headingInput">Heading:</label>
    <input type="text" id="headingInput">

    <label for="paragraphInput">Paragraph:</label>
    <textarea id="paragraphInput"></textarea>

    <button type="button" onclick="addContent()">Add</button>
    <button type="button" onclick="generatePDF()">Generate PDF</button>
    <button type="button" onclick="copyToClipboard()">Copy to Clipboard</button>
  </form>

  <div id="output"></div>

  <script>
    window.jsPDF = window.jspdf.jsPDF;

    let content = []; // Track the content for PDF generation
    let currentDiv = null; // Track the current div being created

    function addContent() {
      var heading = document.getElementById('headingInput').value;
      var paragraph = document.getElementById('paragraphInput').value;

      var outputDiv = document.getElementById('output');

      // Create a new object to store heading and paragraphs together
      var contentItem = { text: [] };

      // Create heading element if heading is entered
      if (heading !== '') {
        // Create a new div for each heading and its corresponding paragraphs
        currentDiv = document.createElement('div');
        outputDiv.appendChild(currentDiv);

        var headingElement = document.createElement('h2');

        var headingCheckbox = document.createElement('input');
        headingCheckbox.type = 'checkbox';
        headingElement.appendChild(headingCheckbox);

        var headingText = document.createElement('span');
        headingText.textContent = heading;
        headingElement.appendChild(headingText);

        // Add heading to the current div
        currentDiv.appendChild(headingElement);

        // Add heading to content item
        contentItem.text.push({ text: heading, style: 'heading', checkbox: headingCheckbox });
      }

      // Create paragraph element if paragraph is entered
      if (paragraph !== '') {
        var paragraphElement = document.createElement('p');

        var checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        paragraphElement.appendChild(checkbox);

        var paragraphText = document.createElement('span');
        paragraphText.textContent = paragraph;
        paragraphElement.appendChild(paragraphText);

        // Add the paragraph to the current div
        currentDiv.appendChild(paragraphElement);

        // Add paragraph to content item
        contentItem.text.push({ text: paragraph, checkbox: checkbox });
      }

      // Add content item to the content array
      if (contentItem.text.length > 0) {
        content.push(contentItem);
      }

      // Clear input fields
      document.getElementById('headingInput').value = '';
      document.getElementById('paragraphInput').value = '';
    }

    function generatePDF() {
      var doc = new jsPDF();

      var yOffset = 10;

      content.forEach(function(contentItem, index) {
        var hasCheckedParagraph = false; // Track if any checked paragraph is present in the current content item

        contentItem.text.forEach(function(item) {
          if (item.style === 'heading' && item.checkbox && item.checkbox.checked) {
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.text(item.text, 10, yOffset);
            yOffset += 10;
          } else if (item.checkbox && item.checkbox.checked) { // Include only checked paragraphs
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text(item.text, 10, yOffset);
            yOffset += 1;
            hasCheckedParagraph = true;
          }
        });

        if (index < content.length - 1 && hasCheckedParagraph) {
          yOffset += 10; // Add extra spacing between content items
        }
      });

      doc.save('output.pdf');
    }

    function copyToClipboard() {
      var checkedContent = [];

      content.forEach(function(contentItem) {
        var checkedParagraphs = contentItem.text.filter(function(item) {
          return item.checkbox && item.checkbox.checked;
        });

        checkedParagraphs.forEach(function(checkedParagraph) {
          checkedContent.push(checkedParagraph.text);
        });
      });

      var textarea = document.createElement('textarea');
      textarea.value = checkedContent.join('\n');
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);

      alert('Checked content has been copied to the clipboard.');
    }
  </script>
</body>
</html>
